
@{
    ViewBag.Title = "ListadoAvisoLlegada";
}

<h2>ListadoAvisoLlegada</h2>
<div class="form">
        <div class="form-group">
           <div id="grid"></div>
        </div>
</div>
   

<script>
    @section JavascriptGlobalVariables {
    //your partial views variables
    }

    @section JavascriptGlobalFunctions {
    function changeLanguageCall(){
        CargarGridAvisoLlegada();
    }
    //Your partial views specific functions
        function CargarGridAvisoLlegada()
        {
            $("#grid").kendoGrid({
                dataSource: {
                    type: "json",
                    transport: {
                        read: "http://localhost:60960/backendsam/api/DummyListadoAvisoLlegada"
                    },
                    pageSize: 20
                },
                height: 550,
                sortable: true,
                filterable: true,
                pageable: {
                    refresh: false,
                    pageSizes: false

                },
                columns: [
                    { field: "FolioAvisoLlegadaID", title: _dictionary.ListadoAvisoLlegada0001[$("#language").data("kendoDropDownList").value()], width: "200px" },
                    { command: { text: _dictionary.ListadoAvisoLlegada0003[$("#language").data("kendoDropDownList").value()], click: showDetails }, title: " ", width: "130px" },
                    { command: { text: _dictionary.ListadoAvisoLlegada0002[$("#language").data("kendoDropDownList").value()], click: borrarFolio }, title: " ", width: "130px" }
                ],
                toolbar: ["destroy"],
                error: function (e) {
                    var json = jQuery.parseJSON(e.responseText);
                    alert("An error has occured: " + json.Message);
                }
            });
        }


        function showDetails(e)
        {
            e.preventDefault();
            var tr = $(e.target).closest("tr");
            var data = this.dataItem(tr);
            window.location.href = "http://localhost:61102/AvisoLlegada/DetalleAvisoLlegada?FolioAvisoLlegadaID=" + data.FolioAvisoLlegadaID;
        }

       
        function borrarFolio(e) {
            e.preventDefault();
            var tr = $(e.target).closest("tr");
            var data = this.dataItem(tr);
            var dataSource = $("#grid").data("kendoGrid").dataSource;

            var client = new $.RestClient('http://localhost:60960/backendsam/api/');
            client.add('DummyListadoAvisoLlegada');
            client.DummyListadoAvisoLlegada.destroy({ folioAvisoLlegadaID: data.FolioAvisoLlegadaID }, { username: "YWRtaW4", token: "RXN0ZUVzVW5Ub2tlbkdlbmVyYWRvRGVBbGd1bmFNYW5lcmE" }).done(function (data) {
                dataSource.remove(data);
            });
            
        }

    }

    @section JavascriptDocumentReadyFunctions {
    //Your partial view document ready functions
    CargarGridAvisoLlegada();
    }
</script>

