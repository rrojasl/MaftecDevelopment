<!DOCTYPE html>
@{
        
}

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>

    <!-- Styles -->
    @Styles.Render("~/Content/bootstrap.css")
    @Styles.Render("~/Content/Styles/site.css")
    @Styles.Render("~/Content/Styles/entities.css")
    @Styles.Render("~/Content/Styles/overrides.css")
    @Styles.Render("~/Content/kendo/2014.2.716/kendo.common.min.css")
    @Styles.Render("~/Content/kendo/2014.2.716/kendo.default.min.css")
    @Styles.Render("~/Content/kendo/2014.2.716/kendo.dataviz.min.css")
    @Styles.Render("~/Content/kendo/2014.2.716/kendo.dataviz.default.min.css")


    <!-- Scripts -->
    @Scripts.Render("~/Scripts/jquery-2.1.4.js")
    @Scripts.Render("~/Scripts/jquery.validate.js")
    @Scripts.Render("~/Scripts/jquery.rest.js")
    @Scripts.Render("~/Scripts/jquery.cookie.js")
    @Scripts.Render("~/Scripts/kendo/2014.2.716/kendo.all.min.js")
    @Scripts.Render("~/Scripts/bootstrap.min.js")
    @Scripts.Render("~/Scripts/translating/dictionary.js")

    @RenderSection("HtmlHead", required: false)
</head>
<body>
    <header>
        <div class="content-wrapper">
            <div class="userInformation">
                <label id="layoutLabel0001"></label>
            </div>
            <div class="languageSelector">
                <input id="language" value="es-MX" />
            </div>
        </div>
    </header>
    <div class="content">
        @RenderBody()
    </div>
    <footer>
        <div class="content-wrapper">
            <label id="layoutLabel0002"></label>
        </div>
    </footer>
    <div class="modal"></div>
    <script>
        /****************************/
        /*     Global Variables     */
        /****************************/

            var $body = $("body");
            var $BackEndSAM = new $.RestClient('' + '/backendsam/api/');
            var $FileManager = new $.RestClient('' + '/filemanager/api/');
            var $MessagesManager = new $.RestClient('' + '/messagesmanager/api/');
            var $SearchManager = new $.RestClient('' + '/searchmanager/api/');
            var $SecurityManager = new $.RestClient('' + '/securitymanager/api/');

            //Partial Views Javascript Code Container
            @RenderSection("JavascriptGlobalVariables", required: false)


        /****************************/
        /*   Traslation Functions   */
        /****************************/

            //Partial Views Javascript Code Container
            @RenderSection("JavascriptGlobalFunctions", required: false)
            
            //Function to change the labels to the corresponding language of the layout page
            function changeLayoutLabels(language) {
                $("label").each(function (index) {
                    if (validateElementExistence(_dictionary[$(this).attr("id")])
                            && validateElementExistence(_dictionary[$(this).attr("id")][language])) {
                        $("#" + $(this).attr("id")).text(_dictionary[$(this).attr("id")][language]);
                    }
                });
            }

            //Function to change language in the onChange trigger of the language dropdownlist
            function changeLanguage() {
                var langValue = this.value();
                kendo.ui.progress($("#grid"), true);
                changeLayoutLabels(langValue);
                $.getScript("../Scripts/kendo/2014.2.716/messages/kendo.messages." + this.value() + ".js", function () {
                    kendo.ui.progress($("#grid"), false);
                });
            }

            //Function to add elements to the dictionary from a string in this form "newItem°es°en|newItem2°es°en"
            function addElementToDictionary(sParam) {
                var elementsToAdd = sParam.split("|");
                for (var i = 0; i < elementsToAdd.length; i++) {
                    var partsOfElement = elementsToAdd[i].split("°");
                    _dictionary[partsOfElement[0]] = {};
                    _dictionary[partsOfElement[0]]["es-MX"] = partsOfElement[1];
                    _dictionary[partsOfElement[0]]["en-US"] = partsOfElement[2];
                }
            }

        /****************************/
        /*    Utilities Functions   */
        /****************************/

            //Function to obtain an url parameter if is not present then return the notFindValue parameter
            function getUrlParameter(sParam, notFindValue) {
                var sPageURL = window.location.search.substring(1);
                var sURLVariables = sPageURL.split('&');
                for (var i = 0; i < sURLVariables.length; i++) {
                    var sParameterName = sURLVariables[i].split('=');
                    if (sParameterName[0] == sParam) {
                        return sParameterName[1];
                    }
                }
                return notFindValue;
            }

            //Function to validate the existence of an element
            function validateElementExistence(element) {
                if (typeof (element) !== 'undefined'
                        && element != null) {
                    return true;
                }
                return false;
            }

            //Function to activate waiting screen
            function loadingStart() {
                $body.addClass("loading");
            }

            //Function to deactivate waiting screen
            function loadingStop() {
                $body.removeClass("loading");
            }

            //Function to encrypt base64 a string
            function encrypt(toEncodData) {
                return window.btoa(toEncodData);
            }

            //Function to decrypt base64 a string
            function decrypt(encodedData) {
                return window.atob(encodedData);
            }

        /****************************/
        /* Document Ready Variables */
        /****************************/

            //Document Ready Section
            $(document).ready(function () {
                //Partial Views Javascript Code Container
                @RenderSection("JavascriptDocumentReadyFunctions", required: false)

                //Add the language parameter to all url invoked by the <a> tag
                $("a").click(function (event) {
                    event.preventDefault();
                    window.location.href = this.href + "?leng=" + $("#language").data("kendoDropDownList").value();
                });

                //Language dropdownlist inicialization method
                $("#language").kendoDropDownList({
                    change: changeLanguage,
                    dataTextField: "text",
                    dataValueField: "value",
                    valueTemplate: '<img src=\"../Content/images/flags/#:data.text#-16.png\" alt=\"#:data.text#\" class="selected-value"/>',
                    template: '<img src=\"../Content/images/flags/#:data.text#.png\" alt=\"#:data.text#\" />',
                    width: 24,
                    dataSource: [
                        { text: "es-MX" }, { text: "en-US" }
                    ]
                });

                //Set on the dropdownlist the url language and change the current language
                $("#language").data("kendoDropDownList").select(_languageOrder[getUrlParameter("leng", "es-MX")]);
                $("#language").data("kendoDropDownList").trigger("change");

            });
    </script>
</body>
</html>
